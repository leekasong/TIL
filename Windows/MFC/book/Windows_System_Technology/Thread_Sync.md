# 스레드 동기화

* 원자성을 보장하며, 크리티컬 영역내의 코드가 작성된 순서대로 동작될 것을 보장하는 매커니즘

#### 원자성
* 일련의 단계들을 필요로 하는 연산에 대해서도 단일 연산인 것처럼 동작하도록 보장
* ex) data++; 는 어셈블리 관점에서는 여러 가지 명령으로 구성되어 있다. 멀티스레드 환경에서 이러한 여러 명령들의 단계를 방해받지 않도록 보장해야 한다는 성질이 원자성이다.

#### 명령어 재배치
* 컴파일러 최적화, CPU에 의한 명령어 재배치, 캐시 등의 이유로 본인이 작성한 코드의 순서대로 동작하지 않을 수 있다.


### 동기화
* 동기화 객체 : 대기 함수에서 스레드에 대해 진행 또는 대기를 판단하는 근거
* 대기 함수 : 스레드의 진행을 멈추게 하거나 잠재우는 것.
* 상태 변경 함수 : 동기화 객체의 상태를 바꾼다.

### 대기 함수 구현방법

* 커널 동기화 객체를 통한 대기 : 해당 스레드를 잠재우고, 실행이 필요하면 통지하여 깨운다.
* 루프를 통한 반복적 대기 : 이른바 '스핀락' 방식이다.
* 두 가지 혼합.

#### reference
![](../../../images/Windows_System_Technology/6.PNG)
